# Makefile for compiling a C program with SDL2 on M1/M2 Mac (Apple Silicon)
# Latest update: November 7, 2023

# Compiler and compiler flags
CC = clang
CFLAGS = -O2 -std=c11 -Wall -Wextra -fPIC -I/opt/homebrew/include/SDL2

# Linker flags
LDFLAGS = -shared -L/opt/homebrew/lib -lSDL2

# Source file and output library name
SRC = SDL_bgi.c
LIB = libSDL_bgi.so

# Header file
HEADER = SDL_bgi.h

# Installation directories
LIB_DIR = /opt/homebrew/lib
INC_DIR = /opt/homebrew/include

# Default target (all)
all: $(LIB)

# Compile the source file into a shared library
$(LIB): $(SRC)
	$(CC) $(CFLAGS) $(LDFLAGS) -o $(LIB) $(SRC)

# Copy the library and header files to installation directories
install: $(LIB) $(HEADER)
	/usr/bin/install -m 755 $(LIB) $(LIB_DIR) ; \
	/usr/bin/install -m 644 $(HEADER) $(INC_DIR)

# Clean up the generated library
clean:
	rm -f $(LIB)

# PHONY targets (targets that don't represent files)
.PHONY: all install clean
